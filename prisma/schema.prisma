// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id            Int                  @id @default(autoincrement())
  username      String               @unique
  password      String
  active        Boolean
  hasPeng       Boolean
  role          Role                 @default(USER)
  courseSection CourseSection[]
  preference    TeachingPreference[]
}

model Schedule {
  id            Int             @id @default(autoincrement())
  year          Int
  createdOn     DateTime        @default(now())
  courseSection CourseSection[]
}

model CourseSection {
  id            Int         @id @default(autoincrement())
  hoursPerWeek  Float
  capacity      Int
  startDate     DateTime
  endDate       DateTime
  meetingTime   MeetingTime @relation(fields: [meetingTimeId], references: [id])
  meetingTimeId Int
  user          User?       @relation(fields: [userId], references: [id])
  userId        Int?
  course        Course      @relation(fields: [courseId], references: [id])
  courseId      Int
  schedule      Schedule?   @relation(fields: [scheduleId], references: [id])
  scheduleId    Int?

}

model Course {
  id                 Int                  @id @default(autoincrement())
  subject            String
  courseCode         String
  term               String
  courseSection      CourseSection[]
  teachingPreference TeachingPreference[]
}

model TeachingPreference {
  id         Int    @id @default(autoincrement())
  preference Int
  course     Course @relation(fields: [courseId], references: [id])
  courseId   Int
  User       User?  @relation(fields: [userId], references: [id])
  userId     Int?
}

model MeetingTime {
  id            Int             @id @default(autoincrement())
  startTime     DateTime
  endTime       DateTime
  days          Day[]
  courseSection CourseSection[]
}

enum Role {
  USER
  ADMIN
}

enum Day {
  MONDAY
  TUESDAY
  WEDNESDAY
  THURSDAY
  FRIDAY
  SATURDAY
  SUNDAY
}
